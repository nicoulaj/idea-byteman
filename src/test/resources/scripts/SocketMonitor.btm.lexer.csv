Byteman:COMMENT;"########################################################################\n# JBoss, Home of Professional Open Source\n# Copyright 2009-2010, Red Hat and individual contributors\n# by the @authors tag. See the copyright.txt in the distribution for a\n# full listing of individual contributors.\n#\n# This is free software; you can redistribute it and/or modify it\n# under the terms of the GNU Lesser General Public License as\n# published by the Free Software Foundation; either version 2.1 of\n# the License, or (at your option) any later version.\n#\n# This software is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n# Lesser General Public License for more details.\n#\n# You should have received a copy of the GNU Lesser General Public\n# License along with this software; if not, write to the Free\n# Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n# 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n#\n# @authors Andrew Dinn\n#\n# SocketMonitor\n#\n# A byteman script which traces thread creation, start, run and exit\n#\n# to use ths script to trace execution of java program org.my.App execute\n#\n#  -- set the directory in which byteman has been installed\n#  BYTEMAN_HOME= ...\n#\n#   -- identify this script\n#   SCRIPT={BYTEMAN_HOME}/sample/scripts/SocketMonitor.txt\n#\n#  ${BYTEMAN_HOME}/bin/bmjava.sh -l $SCRIPT -b org.my.App\n#\n# alternatively to load the script dynamically\n#\n#   -- start the program with the agent\n#  ${BYTEMAN_HOME}/bin/bmjava.sh org.my.App\n#\n#   -- install the script\n#  ${BYTEMAN_HOME}/bin/bmsubmit.sh -l $SCRIPT\n"
WHITE_SPACE;"\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace ServerSocket creation\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"create"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:LT;"<"
Byteman:IDENTIFIER;"init"
Byteman:GT;">"
Byteman:LPAREN;"("
Byteman:IDENTIFIER;"int"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"int"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"InetAddress"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server create ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace ServerSocket creation failed with invalid port\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"create"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"failed"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"with"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"invalid"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"port"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:LT;"<"
Byteman:IDENTIFIER;"init"
Byteman:GT;">"
Byteman:LPAREN;"("
Byteman:IDENTIFIER;"int"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"int"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"InetAddress"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:THROW_KEYWORD;"THROW"
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"1"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server create failed with invalid port ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace ServerSocket creation failed with security exception\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"create"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"failed"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"with"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"security"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"exception"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:LT;"<"
Byteman:IDENTIFIER;"init"
Byteman:GT;">"
Byteman:LPAREN;"("
Byteman:IDENTIFIER;"int"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"int"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"InetAddress"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:THROW_KEYWORD;"THROW"
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"2"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server create failed with security exception ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace ServerSocket creation failed with IOException\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"create"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"failed"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"with"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"IOException"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:LT;"<"
Byteman:IDENTIFIER;"init"
Byteman:GT;">"
Byteman:LPAREN;"("
Byteman:IDENTIFIER;"int"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"int"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"InetAddress"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:THROW_KEYWORD;"THROW"
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"3"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server create failed with IOException ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace ServerSocket bind\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:BIND_KEYWORD;"bind"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:BXOR;"^"
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:BIND_KEYWORD;"bind"
Byteman:LPAREN;"("
Byteman:IDENTIFIER;"SocketAddress"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"int"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server bind ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace ServerSocket accept\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"accept"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:BXOR;"^"
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"accept"
Byteman:LPAREN;"("
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server accept ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace ServerSocket close\n#\n# the AT CALL close location means we do not trace calls to already closed sockets\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"close"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:BXOR;"^"
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"close"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"CALL"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"close"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server close ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace socket create\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"create"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:LT;"<"
Byteman:IDENTIFIER;"init"
Byteman:GT;">"
Byteman:LPAREN;"("
Byteman:IDENTIFIER;"SocketAddress"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"SocketAddress"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"boolean"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** create ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace socket create failed with invalid address\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"create"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"failed"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"with"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"invalid"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"address"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:LT;"<"
Byteman:IDENTIFIER;"init"
Byteman:GT;">"
Byteman:LPAREN;"("
Byteman:IDENTIFIER;"SocketAddress"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"SocketAddress"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"boolean"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:THROW_KEYWORD;"THROW"
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"1"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** create failed with invalid address exception ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace socket create failed with IOException\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"create"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"failed"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"with"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"IOException"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:LT;"<"
Byteman:IDENTIFIER;"init"
Byteman:GT;">"
Byteman:LPAREN;"("
Byteman:IDENTIFIER;"SocketAddress"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"SocketAddress"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"boolean"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:THROW_KEYWORD;"THROW"
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"2"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** create failed with IOException ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace socket bind\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:BIND_KEYWORD;"bind"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:BXOR;"^"
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:BIND_KEYWORD;"bind"
Byteman:LPAREN;"("
Byteman:IDENTIFIER;"SocketAddress"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** bind ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace socket connect\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"connect"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:BXOR;"^"
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"connect"
Byteman:LPAREN;"("
Byteman:IDENTIFIER;"SocketAddress"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:IDENTIFIER;"int"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** connect ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################\n#\n# Rule to trace socket close\n#\n# the AT CALL close location means we do not trace calls to already closed sockets\n#\n"
WHITE_SPACE;"\n"
Byteman:RULE_KEYWORD;"RULE"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"trace"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"close"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS"
WHITE_SPACE;" "
Byteman:BXOR;"^"
Byteman:IDENTIFIER;"java"
Byteman:DOT;"."
Byteman:IDENTIFIER;"net"
Byteman:DOT;"."
Byteman:IDENTIFIER;"Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"close"
Byteman:LPAREN;"("
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"CALL"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"close"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** close ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n"
