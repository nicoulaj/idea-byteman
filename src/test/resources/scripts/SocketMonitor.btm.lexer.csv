Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# JBoss, Home of Professional Open Source"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Copyright 2009-2010, Red Hat and individual contributors"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# by the @authors tag. See the copyright.txt in the distribution for a"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# full listing of individual contributors."
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# This is free software; you can redistribute it and/or modify it"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# under the terms of the GNU Lesser General Public License as"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# published by the Free Software Foundation; either version 2.1 of"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# the License, or (at your option) any later version."
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# This software is distributed in the hope that it will be useful,"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# but WITHOUT ANY WARRANTY; without even the implied warranty of"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Lesser General Public License for more details."
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# You should have received a copy of the GNU Lesser General Public"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# License along with this software; if not, write to the Free"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# 02110-1301 USA, or see the FSF site: http://www.fsf.org."
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# @authors Andrew Dinn"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# SocketMonitor"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# A byteman script which traces thread creation, start, run and exit"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# to use ths script to trace execution of java program org.my.App execute"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#  -- set the directory in which byteman has been installed"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#  BYTEMAN_HOME= ..."
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#   -- identify this script"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#   SCRIPT={BYTEMAN_HOME}/sample/scripts/SocketMonitor.txt"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#  ${BYTEMAN_HOME}/bin/bmjava.sh -l $SCRIPT -b org.my.App"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# alternatively to load the script dynamically"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#   -- start the program with the agent"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#  ${BYTEMAN_HOME}/bin/bmjava.sh org.my.App"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#   -- install the script"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#  ${BYTEMAN_HOME}/bin/bmsubmit.sh -l $SCRIPT"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace ServerSocket creation"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"ServerSocket trace create"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"java.net.ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"<init>(int, int, InetAddress)"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server create ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace ServerSocket creation failed with invalid port"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"ServerSocket trace create failed with invalid port"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"java.net.ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"<init>(int, int, InetAddress)"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:THROW_KEYWORD;"THROW"
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"1"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server create failed with invalid port ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace ServerSocket creation failed with security exception"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"ServerSocket trace create failed with security exception"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"java.net.ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"<init>(int, int, InetAddress)"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:THROW_KEYWORD;"THROW"
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"2"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server create failed with security exception ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace ServerSocket creation failed with IOException"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"ServerSocket trace create failed with IOException"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"java.net.ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"<init>(int, int, InetAddress)"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:THROW_KEYWORD;"THROW"
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"3"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server create failed with IOException ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace ServerSocket bind"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"ServerSocket trace bind"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"^java.net.ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"bind(SocketAddress, int)"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server bind ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace ServerSocket accept"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"ServerSocket trace accept"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"^java.net.ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"accept()"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server accept ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace ServerSocket close"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# the AT CALL close location means we do not trace calls to already closed sockets"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"ServerSocket trace close"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"^java.net.ServerSocket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"close"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"CALL"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"close"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** server close ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace socket create"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"Socket trace create"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"java.net.Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"<init>(SocketAddress, SocketAddress, boolean)"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** create ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace socket create failed with invalid address"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"Socket trace create failed with invalid address"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"java.net.Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"<init>(SocketAddress, SocketAddress, boolean)"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:THROW_KEYWORD;"THROW"
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"1"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** create failed with invalid address exception ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace socket create failed with IOException"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"Socket trace create failed with IOException"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"java.net.Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"<init>(SocketAddress, SocketAddress, boolean)"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:THROW_KEYWORD;"THROW"
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"2"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** create failed with IOException ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace socket bind"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"Socket trace bind"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"^java.net.Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"bind(SocketAddress)"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** bind ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace socket connect"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"Socket trace connect"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"^java.net.Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"connect(SocketAddress, int)"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"EXIT"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** connect ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n\n"
Byteman:COMMENT;"########################################################################"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# Rule to trace socket close"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n"
Byteman:COMMENT;"# the AT CALL close location means we do not trace calls to already closed sockets"
WHITE_SPACE;"\n"
Byteman:COMMENT;"#"
WHITE_SPACE;"\n\n"
Byteman:RULE_KEYWORD;"RULE "
Byteman:RULE_NAME;"Socket trace close"
WHITE_SPACE;"\n"
Byteman:CLASS_KEYWORD;"CLASS "
Byteman:CLASS_REF;"^java.net.Socket"
WHITE_SPACE;"\n"
Byteman:METHOD_KEYWORD;"METHOD "
Byteman:METHOD_REF;"close()"
WHITE_SPACE;"\n"
Byteman:IDENTIFIER;"AT"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"CALL"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"close"
WHITE_SPACE;"\n"
Byteman:IF_KEYWORD;"IF"
WHITE_SPACE;" "
Byteman:TRUE_KEYWORD;"TRUE"
WHITE_SPACE;"\n"
Byteman:DO_KEYWORD;"DO"
WHITE_SPACE;" "
Byteman:IDENTIFIER;"traceStack"
Byteman:LPAREN;"("
Byteman:STRING_LITERAL;""*** close ""
WHITE_SPACE;" "
Byteman:PLUS;"+"
WHITE_SPACE;" "
Byteman:DOLLAR;"$0"
Byteman:COMMA;","
WHITE_SPACE;" "
Byteman:INTEGER_LITERAL;"15"
Byteman:RPAREN;")"
WHITE_SPACE;"\n"
Byteman:ENDRULE_KEYWORD;"ENDRULE"
WHITE_SPACE;"\n"
